const fs=require('fs'); const src=fs.readFileSync('gui_launcher/static/js/guided_builder_v2.js','utf8'); const lines=src.split('\n'); function findBlockStart(keyword){ let depth=0; for(let i=0;i<lines.length;i++){ const ln=lines[i]; if(ln.includes(keyword)) return {line:i+1,depth}; for(const ch of ln){ if(ch==='{' ) depth++; else if(ch==='}') depth--; } } return null;} function findBlockEnd(startLine){ let depth=0; for(let i=0;i<lines.length;i++){ const ln=lines[i]; if(i+1<startLine){ for(const ch of ln){ if(ch==='{' ) depth++; else if(ch==='}') depth--; } continue; } // at or after startLine for(const ch of ln){ if(ch==='{' ) depth++; else if(ch==='}') depth--; } if(depth<=0) return i+1; } return null;} const start=findBlockStart('function ruleRow('); console.log('ruleRow start',start); const end=findBlockEnd(start.line); console.log('ruleRow end',end); // find first if(section) after ruleRow start for(let i=start.line-1;i<lines.length;i++){ if(lines[i].includes('if (section')||lines[i].includes('if(section')){ console.log('first if(section) after ruleRow at',i+1); break;} }