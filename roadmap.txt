TradingLab Roadmap

Updated: 2026-02-12

Guiding principles
- Zero-support friendly: everything must be self-serve via GUI + docs + run bundles.
- No-code first: strategy iteration should not require touching Python.
- Deterministic by default: specs compile deterministically; backtests are reproducible.
- Mental model alignment: discretionary → systematic should feel like:
   Regime/Context → Trigger → Filters → Risk/Exits → Iterate.

============================================================
NOW: Guided Strategy Builder (Product Core)
============================================================

Goal
- Make the Guided Strategy flow “chart-observer usable” by providing:
   - Context/Regime tools (starting with MA stack + slope + distance)
   - Trigger tools (starting with pin bar, inside bar, engulfing)
   - Filters (session/calendar + direction alignment)
   - Fast iterate loop (edit spec → compile → rerun)

Non-goals (for now)
- Subjective constructs that require heavy discretion definitions:
   - “major S/R”, “trendlines”, “double bottom”, “between two trend lines”
   These can be added later via pivot/level abstractions.
- SaaS hosting / payments / auth.

Roadmap structure
- Each milestone should end with:
   - a GUI workflow users can complete
   - deterministic output specs
   - at least one end-to-end example (docs)
   - tests for the new building blocks

------------------------------------------------------------
M0. Stabilize the iteration loop (DONE)
------------------------------------------------------------
- Strategies page: list/edit spec, compile, backtest.
- Runs page: rerun (same settings) + export bug report zip.
- Help page + docs entry for GUI launcher.

------------------------------------------------------------
M1. Strategy Builder v2: “Context → Trigger” wizard (GUI)
------------------------------------------------------------
Deliverables
- New Guided flow mode: “Builder v2 (Context/Trigger)”.
- Step 1: Market + timeframe roles
   - Entry TF
   - Optional Context TF (HTF)
   - Optional Multi-TF direction rule: trade only in HTF direction
- Step 2: Context (Regime) builder: MA stack family
   - MA type: EMA/SMA
   - Stack alignment (examples):
      - Bull: ema20 > ema50 > ema200
      - Bear: ema20 < ema50 < ema200
   - Slope filter (on chosen MA): slope up/down with lookback bars
   - Distance filter:
      - price distance from MA (percent or ATR-multiple)
      - MA-to-MA distance (avoid choppy compression)
- Step 3: Trigger builder (initial 3)
   - Pin bar (bullish/bearish)
   - Inside bar breakout (bull/bear)
   - Engulfing (bullish/bearish)
- Step 4: Setup rules + previews (Context + Signals + Triggers)
   - Multi-item rule lists per side (AND), persisted as JSON in the draft.
   - Live textual preview built from effective compiled expressions.
   - Context visual preview (candles + primary context overlays + shading).
   - Setup visual preview (candles on entry TF + context shading + markers when ALL(Context+Signals+Triggers) align).
   - Mixed timeframe behavior: context is evaluated on Context TF and forward-filled to entry TF for plotting/eval alignment.
- Step 5: Risk + exits (reuse current guided advanced)
   - ATR stop / percent stop
   - TP / partial / trailing
- Review step
   - Show “human sentence” summary of the full strategy
   - Show generated YAML spec (editable)
   - Buttons: Save → Compile → Backtest

Acceptance criteria
- User can build a strategy using MA-stack context + one candle trigger without touching code.
- Generated `StrategySpec` validates and compiles.
- Backtest from GUI produces a report; overlays match strategy indicators.

Status (as of 2026-02-11)
- Step 4 previews (context + setup) shipped; setup supports multi-item Context/Signals/Triggers; mixed-timeframe forward-fill is explicitly labeled.
- Builder v2 alignment semantics stabilized:
   - `align_with_context` aligns bullish context to LONG and bearish context to SHORT (when both sides enabled).
   - Signals/triggers keep correct polarity (LONG=bull, SHORT=bear), independent of context alignment.
- MA-based context types now support optional slope + separation filters (beyond MA-stack).

Status (as of 2026-02-12)
- Step 5 (Advanced) now includes risk/limits/cost overrides for Builder v2:
   - sizing mode + account size
   - max trades per day + optional max daily loss
   - optional commission/slippage overrides (defaults remain market-profile-driven)
- Remaining work: review-step “human sentence” polish, screenshot-based user docs.

------------------------------------------------------------
M2. Pattern primitives (Engine/Indicators)
------------------------------------------------------------
Why
- Candle patterns must be deterministic and testable.

Deliverables
- Add indicator functions / primitives (names TBD by existing DSL conventions):
   - `pin_bar(open, high, low, close, ...)`
   - `inside_bar(high, low, ...)`
   - `engulfing(open, high, low, close, ...)`
- Parameters exposed in GUI (sane defaults):
   - body-to-wick ratios
   - minimum range filters (optional)
   - lookback references for inside bar

Tests
- Unit tests with known candle sequences.
- Cross-check invariants (e.g., bullish and bearish patterns are mutually exclusive on same bar unless explicitly allowed).

------------------------------------------------------------
M3. Regime library (MA-stack expansion)
------------------------------------------------------------
Deliverables
- Regime “presets” that map to MA-stack parameters:
   - Trend: stack aligned + slope
   - Choppy filter: MA distance below threshold (avoid), or require above threshold
   - Pullback context: price within band around fast MA
   - Breakout context (MA-based): price compression then expansion (simple proxy)
- GUI UX: select a preset then optionally “advanced tweak”.

Acceptance criteria
- Users can reason in natural terms (“trend”, “chop”) but system stays MA-based.

------------------------------------------------------------
M4. Builder ergonomics + guardrails
------------------------------------------------------------
Deliverables
- “Why no trades?” hints before running:
   - warn if context+trigger combination is likely too strict
   - show estimated signal frequency preview (optional; computed cheaply from recent bars)
- Visual preview:
   - Setup chart exists (candles + context shading + setup markers). Remaining: richer “why” overlays (e.g., show which sub-component failed) and frequency estimate.
- Better naming + versioning:
   - enforce safe naming and suggest v2/v3 names

------------------------------------------------------------
M4.1 Advanced builder: market-aware defaults + units (NEW)
------------------------------------------------------------
Why
- Avoid FX-centric defaults leaking into futures/crypto/stocks.
- Reduce user confusion by labeling distances in instrument-native units (pips vs ticks vs points vs price).

Deliverables
- Market metadata normalization
   - Extend `config/market_profiles.yml` with: `tick_size`, `distance_unit`, `instrument_group`.
   - Extend `engine.market.MarketSpec` to carry `tick_size` so the UI can convert ticks↔price.
   - Add shared conversion helpers (native distance ↔ price) for GUI + validation.
- Advanced builder defaults resolver
   - New layered defaults file (global → asset_class → instrument_group → symbol).
   - Prefill realistic defaults per market/symbol; guardrails are OFF by default.
- Advanced editor/session UX
   - Custom UTC (GMT+00) trading windows (start/end), not just session toggles.
   - Multi-level take-profit ladder + multi-level partial exits (add/remove levels).
   - Early exit when context invalidates (OFF by default).
- Backtest validation realism
   - Slippage model ON by default for validation/backtests; values come from market-aware defaults.
- Futures specifics
   - Explicit micros vs minis (profiles + defaults): tick sizes, tick values, contract sizes, and conservative slippage.

Acceptance criteria
- A futures user sees ticks/points labels, an FX user sees pips labels, and a crypto user sees price/% labels.
- Backtests/validation include slippage by default and remain deterministic.
- Advanced builder can create multi-level TP/partials without manual YAML editing.

Shipped (as of 2026-02-11)
- Execution option: early exit when context invalidates (OFF by default): `execution.exit_if_context_invalid` with modes `immediate` or `tighten_stop`.
- Engine guardrails: stop-distance constraints at entry (min + optional max).

Shipped (as of 2026-02-12)
- Advanced defaults now surface market commission hints (`commission_rate`, `commission_per_contract`) for GUI display.

------------------------------------------------------------
M5. Report UX improvements for builders
------------------------------------------------------------
Deliverables
- Trade chart overlays driven by strategy intent (already in place) and expanded for new indicators.
- In report JSON, include:
   - counts of triggers by type
   - counts of filtered-out triggers by filter

------------------------------------------------------------
M6. Documentation: “No-code strategy building” book chapter
------------------------------------------------------------
Deliverables
- docs/user guide that mirrors the wizard steps with screenshots later.
- Pattern glossary (definitions + parameters).
- Troubleshooting guide: no trades, too many trades, overfitting warnings.

Near-term follow-ups (not required for core flow)
- Visualizing arbitrary custom DSL rules in the setup preview (currently best-effort; unsupported rules are counted/reported).
- Optional: per-stage markers/overlays for Context vs Signals vs Triggers (beyond legend-toggle markers).

============================================================
NEXT: Validation product (later, monetizable)
============================================================

V1. Validation UX in GUI
- Add a GUI page to run Phase 1/2/holdout scripts and view results.
- Make validation reproducible and “bundle-first”.

V2. Robustness gates
- Clear pass/fail gates with explanations.
- Stationarity / degradation monitoring.

============================================================
LATER: Advanced discretionary concepts
============================================================

A1. Levels & structure
- Pivots, clustered levels, proximity thresholds.
- Double bottom/top (objective pivot-based definition).

A2. Volatility regimes
- Bollinger squeeze, ATR percentile, realized vol.
- Expansion triggers.

A3. Breakout families
- Donchian breakout (clean).
- Market structure breaks (harder).

============================================================
Long-term systems work
============================================================

P. Portfolio layer
- Multi-strategy/multi-market allocation, correlation-aware risk caps, exposure constraints.
- Portfolio-level performance attribution and reporting.

E. Execution realism upgrades
- Partial fills, fee schedules, funding/borrow, spread models, latency models.